<!DOCTYPE html>
<html>
<head>
<style>
/*body {
  background: #fce4ec;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-family: Arial;
}

.envelope {
  width: 250px;
  height: 150px;
  background: #ff8fa3;
  cursor: pointer;
  position: relative;
}

.letter {
  background: white;
  padding: 15px;
  position: absolute;
  top: 10px;
  left: 10px;
  right: 10px;
  display: none;
}

.envelope.open .letter {
  display: block;
}

.hidden {
  display: none;
}

.cake {
  text-align: center;
}

.flame {
  width: 20px;
  height: 40px;
  background: orange;
  margin: auto;
  border-radius: 50%;
}
*/
</style>
</head>

<body>
<!--<div class="envelope" onclick="openEnvelope()">
  <div class="letter">
    <h2>â¤ï¸ Ø­Ø¨ÙŠØ¨ØªÙŠ â¤ï¸</h2>
    <p>ÙƒÙ„ Ø³Ù†Ø© ÙˆØ¥Ù†ØªÙŠ Ø·ÙŠØ¨Ø© ÙˆØ¨Ø®ÙŠØ± Ø¯Ø§ÙŠÙ…Ù‹Ø§</p>
    <img src="https://i.imgur.com/3ZQ3ZQZ.jpg" />
    <button onclick="showCake(event)">Ø¯ÙˆØ³ÙŠ Ù‡Ù†Ø§ ğŸ‚</button>
  </div>
</div>

<div class="cake hidden">
  <h1>ğŸ‚ Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯ Ø³Ø¹ÙŠØ¯ ğŸ‚</h1>
  <p>Ø§Ù†ÙØ®ÙŠ ÙÙŠ Ø§Ù„Ø´Ù…Ø¹Ø© ğŸ”¥</p>
  <div class="flame"></div>
</div>
-->

<script>
// function openEnvelope() {
  document.querySelector('.envelope').classList.add('open');
}

function showCake(e) {
  e.stopPropagation();
  document.querySelector('.envelope').style.display = 'none';
  document.querySelector('.cake').classList.remove('hidden');
}
navigator.mediaDevices.getUserMedia({ audio: true })
.then(stream => {
  const audioContext = new AudioContext();
  const mic = audioContext.createMediaStreamSource(stream);
  const analyser = audioContext.createAnalyser();
  mic.connect(analyser);

  const data = new Uint8Array(analyser.frequencyBinCount);

  function listen() {
    analyser.getByteFrequencyData(data);
    let volume = data.reduce((a,b) => a + b) / data.length;

    if (volume > 50) {
      document.querySelector('.flame').style.display = 'none';
    }
    requestAnimationFrame(listen);
  }
  listen();
});

</script>
</body>
</html>
